<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8">
    <title><%= title %></title>
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/bootstrapv3.css">
    <script src="/bower_components/jquery.js" type="text/javascript"></script>
    <script src="/bower_components/bootstrapv3.js"></script>
    <script src="/bower_components/bootstrap-paginator.js"></script>

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" href="/assets/css/font-awesome.css" />

    <!-- page specific plugin styles -->

    <!-- text fonts -->
    <link rel="stylesheet" href="/assets/css/ace-fonts.css" />

    <!-- ace styles -->
    <link rel="stylesheet" href="/assets/css/ace.css" class="ace-main-stylesheet" id="main-ace-style" />

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/assets/css/ace-part2.css" class="ace-main-stylesheet" />
    <![endif]-->

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/assets/css/ace-ie.css" />
    <![endif]-->

    <!-- inline styles related to this page -->

    <!-- ace settings handler -->
    <script src="/assets/js/ace-extra.js"></script>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
    <script src="/assets/js/html5shiv.js"></script>
    <script src="/assets/js/respond.js"></script>
    <![endif]-->
</head>
<body>
<!--<div class="clearfix page-nav">
    <% if(user) {%>
    <div class="pull-left nav-username">欢迎你，<%= user.username%>! </div>
    <div class="pull-left"><a href="/post">发表</a></div>
    <div class="pull-right nav-quit"><a href="/quit">退出</a></div>
    <% }else{ %>
    <div class="pull-right nav-register"><a href="/register">注册</a></div>
    <div class="pull-right nav-login"><a href="/login">登录</a></div>
    <% }%>
</div>-->

<div id="navbar" class="navbar navbar-default">

    <div class="navbar-container" id="navbar-container">
        <div class="navbar-header pull-left">
            <a class="navbar-brand">
                <small>
                    <i class="fa fa-leaf"></i>
                    在线日记本
                </small>
            </a>
        </div>
        <div class=" pull-right">
            <ul class="nav ace-nav">
                <li>
                    <a href="/post" class="btn btn-yellow btn-minier no-radius">
                        <i class="ace-icon fa fa-pencil-square-o bigger-160"></i>
                        发表
                    </a>
                </li>

                <li>
                    <a href="/quit" class="btn  btn-purple btn-minier">
                        <i class="ace-icon fa fa-undo bigger-160"></i>
                        退出
                    </a>
                        </li>

                <!-- #section:basics/navbar.user_menu -->
                <li class="light-blue">
                    <a data-toggle="dropdown" class="dropdown-toggle">
                        <img class="nav-user-photo" src="/assets/avatars/user.jpg" alt="Jason's Photo" />
								<span class="user-info">
									<small>欢迎,</small>
                                    <%= user.username%>
								</span>
                    </a>
                </li>
            </ul>
        </div>
    </div><!-- /.navbar-container -->
</div>

<div class="text-center">
<div class="page-header">
    <h1>
        <%= user.username%>
        <small>
            <i class="ace-icon fa fa-angle-double-right"></i>
            笔记列表
        </small>
    </h1>
</div>
</div>
            <div class="container">
    <div class="row">
        <table class="table table-striped">
            <thead>
            <tr>
                <th>标题</th>
                <th>标签</th>
                <th>日期</th>
            </tr>
            </thead>
            <tbody>
            <% notes.forEach(function(note){%>
            <tr>
                <td>
                    <a href="/detail/<%= note._id %>"><%= note.title %></a>
                </td>
                <td><%= note.tag %></td>
                <td><%= note.createTime%></td>
            </tr>
            <%});%>
            </tbody>
        </table>
    </div>
</div>
<div class="text-center">
<nav>
    <ul class="pagination">
        <li>
            <a href="/list?pageNo=0" aria-label="Previous">
            <span aria-hidden="true">首页</span>
        </a>
        </li>
        <%
        var currentPage = 0;
        var totalPage = 0;
        var totalNum = 0
        var num = 5;//每页笔记条数
        var num2 = 5;//分页条最多显示的页数
        if(pageNo)currentPage = parseInt(pageNo);//当前页号
        if(total){
            totalNum = parseInt(total);//总条目数
            totalPage = Math.ceil(totalNum/num);//总页数
        }
        if(currentPage){  //判断当前页是否存在上一页
        %>
        <li>
            <a href="/list?pageNo=<%=currentPage-1;%>" aria-label="Previous">
            <span aria-hidden="true">上页</span>
        </a>
        </li>
        <%}
        var active="";
        var n = totalPage>num2?num2:totalPage;//取总页数和5的较小值
        var begin = totalPage-currentPage<n?totalPage-n:currentPage;//确定分页条的起始点
        for(i=0;i<n;i++){   //将被选中的页加标记
            if(begin+i==currentPage)
            active="active";
            else
                active="";
        %>
        <li class=<%=active;%>><a href="/list?pageNo=<%=begin+i;%>"> <%=begin+i+1;%> </a></li>
        <%}if(currentPage!=totalPage-1){//判断当前页是否存在下一页%>
        <li>
            <a href="/list?pageNo=<%=currentPage+1;%>" aria-label="Next">
            <span aria-hidden="true">下页</span>
        </a>
        </li>
        <%}%>
        <li>
            <a href="/list?pageNo=<%=totalPage-1;%>" aria-label="Next">
            <span aria-hidden="true">末页</span>
        </a>
        </li>
    </ul>
</nav>
</div>
</body>
</html>